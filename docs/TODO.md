# 项目待办事项 (TODO)

## 📋 文档说明

本文档记录项目的待办事项和开发计划，按优先级和模块分类整理。

## 🎯 更新规范

每次添加新的待办事项时，需要按以下格式记录：

1. **任务描述**：清晰描述任务内容和目标
2. **优先级**：高/中/低
3. **预计工时**：预估开发时间
4. **依赖关系**：前置任务和依赖
5. **验收标准**：完成标准

---

## 🗂️ 按功能模块分类

### 📚 英语学习模块

#### 🎯 智能练习功能

##### 数据分析功能开发

**任务描述**
- 开发英语学习-智能练习-数据分析功能
- 参考qwerty learner的数据分析功能
- 包括练习次数热力图、练习单词数热力图、WPM趋势图、正确率趋势图、按键错误分析

**优先级**：高

**预计工时**：3-5天

**依赖关系**
- 现有智能练习功能
- 数据收集机制

**验收标准**
1. 数据分析入口正常显示和跳转
2. 所有图表组件正常渲染
3. 数据聚合和计算准确
4. 页面响应式设计适配
5. 性能优化，加载速度合理

**开发计划**

###### 第一阶段：数据模型和API (1-2天)
- [ ] 创建数据分析相关数据模型
  - [ ] TypingPracticeRecord 模型
  - [ ] DailyPracticeStats 模型  
  - [ ] KeyErrorStats 模型
- [ ] 实现数据收集逻辑
  - [ ] 练习记录详细数据收集
  - [ ] 按键错误统计
  - [ ] 每日数据聚合
- [ ] 开发数据分析API接口
  - [ ] 热力图数据接口
  - [ ] 趋势图数据接口
  - [ ] 按键错误统计接口

###### 第二阶段：前端组件 (1-2天)
- [ ] 创建图表组件
  - [ ] HeatmapChart 热力图组件
  - [ ] LineChart 趋势图组件
  - [ ] KeyboardErrorChart 键盘错误图组件
- [ ] 实现数据分析页面
  - [ ] 页面布局和样式
  - [ ] 数据加载和状态管理
  - [ ] 时间范围选择功能
- [ ] 添加数据分析入口
  - [ ] 练习页面顶部栏添加图标
  - [ ] 路由配置和跳转逻辑

###### 第三阶段：优化和测试 (1天)
- [ ] 性能优化
  - [ ] 数据缓存机制
  - [ ] 分页加载优化
  - [ ] 图表渲染优化
- [ ] 用户体验优化
  - [ ] 加载状态显示
  - [ ] 错误处理机制
  - [ ] 响应式设计完善
- [ ] 功能测试
  - [ ] 数据准确性测试
  - [ ] 图表交互测试
  - [ ] 兼容性测试

**技术要点**
1. 复用qwerty learner的图表组件和逻辑
2. 确保数据收集的完整性和准确性
3. 优化大数据量下的性能表现
4. 保持与现有UI风格的一致性

**相关文件**
- `backend/apps/english/models.py`：数据模型
- `backend/apps/english/views.py`：API接口
- `frontend/src/views/english/DataAnalysis.vue`：数据分析页面
- `frontend/src/components/charts/`：图表组件

---

### 🧪 测试系统完善

#### 测试覆盖率和用例完善

**任务描述**
- 分析当前测试覆盖情况，完善测试用例
- 修复现有测试中的问题，提高测试通过率
- 建立完整的测试体系和质量保证机制

**优先级**：高

**预计工时**：2-3天

**依赖关系**
- 现有测试框架和配置
- 项目功能模块

**验收标准**
1. 测试通过率达到95%以上
2. 核心功能模块测试覆盖率85%以上
3. 建立完整的测试文档和规范
4. 自动化测试流程正常运行

**修复进展**

###### 第一阶段：模型字段修复 ✅ (已完成)
- [x] 修复Word模型字段不匹配问题
  - [x] `pronunciation` → `phonetic`
  - [x] `example_sentence` → `example`
- [x] 修复News模型字段不匹配问题
  - [x] `url` → `source_url`
  - [x] `published_date` → `publish_date`
- [x] 修复TypingWord模型字段不匹配问题
  - [x] `category` → `dictionary`外键关系
- [x] 修复UserProfile模型字段问题
  - [x] `avatar_url`默认值处理

###### 第二阶段：数据库配置修复 ✅ (已完成)
- [x] 修复MySQL连接测试的SQL语法兼容性
- [x] 添加数据库访问权限标记`@pytest.mark.django_db`
- [x] 支持SQLite和MySQL两种数据库引擎

###### 第三阶段：API路由修复 ✅ (已完成)
- [x] 修复健康检查URL: `/api/health/`
- [x] 修复用户认证URL: `/api/v1/auth/login/`, `/api/v1/auth/register/`, `/api/v1/auth/logout/`
- [x] 修复英语学习API URL: `/api/v1/english/words/`, `/api/v1/english/expressions/`, `/api/v1/english/news/`
- [x] 删除不存在的功能测试文件

###### 第四阶段：爬虫功能修复 ✅ (已完成)
- [x] 修复BBC和TechCrunch爬虫的`source` → `source_name`属性
- [x] 调整内容长度验证标准（从50词降低到30词）
- [x] 修复爬虫初始化测试

###### 第五阶段：核心功能测试用例补充 ✅ (已完成)
- [x] 补充用户认证模块测试用例 (25个) - `tests/unit/test_user_auth.py`
  - [x] 用户注册测试 (5个用例)
  - [x] 用户登录测试 (5个用例)
  - [x] 密码重置测试 (3个用例)
  - [x] 权限验证测试 (5个用例)
  - [x] 用户身份验证测试 (4个用例)
  - [x] 用户登出测试 (2个用例)
- [x] 补充英语学习核心功能测试用例 (32个) - `tests/unit/test_english_learning.py`
  - [x] 单词学习测试 (8个用例)
  - [x] 表达学习测试 (6个用例)
  - [x] 新闻阅读测试 (8个用例)
  - [x] 打字练习测试 (10个用例)
- [x] 补充文章管理功能测试用例 (21个) - `tests/unit/test_article_management.py`
  - [x] 文章创建测试 (5个用例)
  - [x] 文章编辑测试 (5个用例)
  - [x] 文章删除测试 (3个用例)
  - [x] 文章搜索测试 (5个用例)
  - [x] 文章详情测试 (3个用例)

###### 第六阶段：高级功能测试用例补充 🔄 (进行中)
 - [x] 补充数据分析功能测试用例 (22个) - ✅ 已完成
   - 创建了 `tests/unit/test_data_analysis.py`
   - 包含服务层测试、API测试、边界情况测试、性能测试
   - 覆盖热力图、趋势图、错误统计、数据概览等功能
 - [ ] 补充权限管理测试用例 (12个)
 - [ ] 补充爬虫功能测试用例 (20个)
 - [ ] 补充系统集成测试用例 (15个)

###### 第七阶段：测试用例管理优化 🔄 (进行中)
 - [x] 制定测试用例管理策略 - `tests/TEST_MANAGEMENT_STRATEGY.md`
 - [x] 创建模块化测试示例 - `tests/unit/auth/test_registration.py`
 - [x] 实现战略性测试执行脚本 - `tests/run_tests_strategic.py`
 - [ ] 重构现有测试用例为模块化结构
 - [ ] 实现测试工厂模式
 - [ ] 建立测试监控和报告系统
 - [ ] 配置持续集成测试流程

**技术要点**
1. 确保测试用例与实际模型字段一致
2. 建立标准化的测试用例模板
3. 优化测试执行性能
4. 完善测试文档和规范

**相关文件**
- `tests/TEST_COVERAGE_ANALYSIS.md`：测试覆盖分析报告
- `tests/TEST_IMPROVEMENT_PLAN.md`：测试改进计划
- `tests/unit/`：单元测试文件
- `tests/integration/`：集成测试文件
- `tests/regression/`：回归测试文件
- `docs/ENGLISH_TYPING_INTEGRATION_DESIGN.md`：产品设计文档

---

#### 🔧 现有功能优化

##### 暂停功能完善

**任务描述**
- 完善智能练习页面的暂停功能
- 确保计时器正确停止和启动
- 修复响应式更新问题

**优先级**：中

**预计工时**：0.5天

**状态**：已完成 ✅

**验收标准**
1. 暂停按钮正常工作
2. 计时器正确停止和启动
3. 时间显示准确
4. 键盘输入在暂停状态下被禁用

---

#### 🐛 Bug修复

##### 发音功能优化

**任务描述**
- 优化单词发音功能
- 解决发音重叠和重复播放问题
- 完善发音组件生命周期管理

**优先级**：中

**预计工时**：0.5天

**状态**：已完成 ✅

**验收标准**
1. 自动发音正常工作
2. 无发音重叠问题
3. 发音组件正确管理
4. 资源正确清理

---

### 🌐 新闻模块

#### 📰 新闻爬虫优化

##### 新闻源扩展

**任务描述**
- 扩展新闻爬虫支持的新闻源
- 添加更多英语新闻网站
- 优化爬虫稳定性和效率

**优先级**：中

**预计工时**：2-3天

**依赖关系**
- 现有新闻爬虫架构
- 新闻数据模型

**验收标准**
1. 新增新闻源正常工作
2. 爬虫稳定性提升
3. 数据质量符合要求
4. 性能无明显下降

---

#### 🎨 新闻阅读界面

##### 移动端适配

**任务描述**
- 优化新闻阅读界面的移动端体验
- 改进响应式设计
- 提升移动端交互体验

**优先级**：低

**预计工时**：1-2天

**验收标准**
1. 移动端显示正常
2. 交互体验流畅
3. 阅读体验良好
4. 性能表现优秀

---

### 🔧 系统优化

#### ⚡ 性能优化

##### 数据库查询优化

**任务描述**
- 优化数据库查询性能
- 添加必要的索引
- 优化慢查询

**优先级**：中

**预计工时**：1-2天

**验收标准**
1. 查询响应时间提升
2. 数据库负载降低
3. 系统整体性能改善

---

#### 🛡️ 安全加固

##### 用户认证优化

**任务描述**
- 完善用户认证机制
- 添加安全防护措施
- 优化权限管理

**优先级**：中

**预计工时**：1天

**验收标准**
1. 认证机制安全可靠
2. 权限管理完善
3. 安全防护有效

---

## 📊 项目统计

### 已完成任务
- ✅ 智能练习基础功能
- ✅ 暂停功能完善
- ✅ 发音功能优化
- ✅ 词库导入功能
- ✅ 测试系统基础设施建设
- ✅ 英语学习模块测试用例 (数据分析、暂停/继续、发音功能)
- ✅ 用户认证模块测试用例 (登录、注册、密码重置、权限管理)

### 进行中任务
- 🔄 数据分析功能开发

### 待开始任务
- ⏳ 个人主页模块测试用例开发
- ⏳ 文章管理模块测试用例开发
- ⏳ 分类管理模块测试用例开发
- ⏳ 用户管理模块测试用例开发
- ⏳ 新闻源扩展
- ⏳ 移动端适配
- ⏳ 性能优化
- ⏳ 安全加固

---

## 🧪 测试系统建设

### ✅ 已完成测试系统

#### 测试基础设施
- ✅ 测试目录结构标准化
- ✅ MySQL测试数据库配置
- ✅ 一键测试脚本实现
- ✅ 测试报告生成系统
- ✅ 测试覆盖分析文档

#### 英语学习模块测试 (44个测试用例)
- ✅ 数据分析功能测试 (8个测试)
  - API接口测试
  - 服务层逻辑测试
  - 单元测试
  - 集成测试
- ✅ 暂停/继续功能测试 (18个测试)
  - API接口测试
  - 服务层逻辑测试
  - 单元测试
  - 集成测试
  - 前端模拟测试
- ✅ 发音功能测试 (18个测试)
  - API接口测试
  - 服务层逻辑测试
  - 单元测试
  - 集成测试
  - 前端模拟测试

#### 用户认证模块测试 (39个测试用例)
- ✅ 用户认证测试 (25个测试)
  - 用户注册测试
  - 用户登录测试
  - 密码重置测试
  - Token认证测试
  - 集成测试
  - 前端模拟测试
- ✅ 权限管理测试 (14个测试)
  - 用户权限测试
  - 文章权限测试
  - 分类权限测试
  - 用户组权限测试
  - 权限集成测试

### 📊 测试覆盖统计
- **总测试数**: 92个测试
- **通过率**: 100% (90个通过，2个跳过)
- **总体功能覆盖率**: 18.0%
- **高优先级功能覆盖率**: 50.0%

### 🔄 下一步测试计划

#### 第三阶段：个人主页模块测试 (20个功能)
- ⏳ 首页功能测试 (9个功能)
  - 欢迎横幅测试
  - 统计数据测试
  - 文章轮播测试
  - 最新文章测试
  - 热门标签测试
- ⏳ 导航组件测试 (8个功能)
  - 导航菜单测试
  - 下拉菜单测试
  - 搜索功能测试
  - 用户状态测试

#### 第四阶段：管理功能测试 (14个功能)
- ⏳ 文章管理测试 (8个功能)
  - 文章CRUD测试
  - 搜索功能测试
  - 编辑功能测试
  - 统计功能测试
- ⏳ 分类管理测试 (6个功能)
  - 分类CRUD测试
  - 权限控制测试

#### 第五阶段：用户功能测试 (4个功能)
- ⏳ 用户管理测试 (4个功能)
  - 个人信息测试
  - 文章管理测试

---

## 🚀 开发规范

### 代码质量要求
1. **代码规范**：遵循项目代码规范
2. **测试覆盖**：新功能需要测试用例
3. **文档更新**：及时更新相关文档
4. **性能考虑**：注意性能影响

### 提交规范
1. **提交信息**：清晰描述变更内容
2. **分支管理**：使用功能分支开发
3. **代码审查**：重要功能需要代码审查
4. **测试验证**：提交前进行测试

---

*最后更新：2025-01-17*
*更新内容：完成测试系统基础设施建设，英语学习模块和用户认证模块测试用例开发*
*维护者：开发团队*

