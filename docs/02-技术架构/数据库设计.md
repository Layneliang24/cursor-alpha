# 技术架构 - 数据库设计（基于现有博客系统扩展）

## 1. 设计原则
- 复用核心表（users、articles 等），新增表独立命名空间；对既有表的改动遵循"可空/有默认值"优先。
- 各模块独立 migrations，避免交叉依赖；变更先预发验证，提供可回滚脚本。

## 2. 复用与可选扩展
- 复用：users（扩展见系统管理-用户管理）、articles/categories/tags。
- 可选扩展字段（文章）：source_url、is_crawled、published_at（均可空，最小侵入）。

## 3. 新增表（摘要）
- 英语（english_*）：english_words、english_expressions、english_news、user_word_progress
- 求职（job_*）：resume_templates、resumes、companies、interviews、skills
- 待办（todo_*）：todos、notes、reminders
- AI（ai_*）：ai_models、ai_conversations、ai_messages、ai_kb_collections

## 4. 示例 DDL
```sql
CREATE TABLE english_words (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  word VARCHAR(128) NOT NULL,
  phonetic VARCHAR(128),
  meaning TEXT,
  examples JSON,
  tags JSON,
  source VARCHAR(64),
  level ENUM('beginner','intermediate','advanced') DEFAULT 'beginner',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE ai_conversations (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  title VARCHAR(200),
  model_id BIGINT,
  status ENUM('active','archived','deleted') DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

## 5. 索引与性能
- 高频检索字段（word/title/user_id/status/created_at）建 BTREE 索引；大文本避免频繁 LIKE（必要时引入 ES）。
- 2GB 环境：连接池小型化、分页默认阈值合理化。

## 6. 迁移与回滚
- 各模块独立 migrations；小步快跑；必要时准备影子表与回滚脚本。

