# 简历系统设计

## 1. 系统概述

### 1.1 系统定位
简历系统是求职管理模块的核心组件，提供专业的简历设计、编辑、管理和导出功能，支持多种格式和模板，满足不同行业和职位的需求。

### 1.2 核心功能
- **可视化编辑器**：拖拽式简历编辑器
- **模板系统**：丰富的专业模板库
- **多格式导出**：Word、PDF、HTML格式支持
- **版本管理**：简历版本控制和历史记录
- **响应式设计**：适配不同设备和屏幕

### 1.3 技术架构
```
简历系统
├── 编辑器引擎
│   ├── 拖拽组件
│   ├── 实时预览
│   └── 数据绑定
├── 模板引擎
│   ├── 模板管理
│   ├── 样式系统
│   └── 主题定制
├── 导出引擎
│   ├── Word生成
│   ├── PDF生成
│   └── HTML生成
└── 数据管理
    ├── 版本控制
    ├── 数据同步
    └── 备份恢复
```

## 2. 编辑器设计

### 2.1 可视化编辑器

#### 2.1.1 编辑器布局
```
┌─────────────────────────────────────────────────────────────┐
│  工具栏                                                      │
│  [添加模块] [模板] [预览] [导出] [保存] [撤销] [重做]        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐  ┌─────────────────────────────────┐   │
│  │   模块库        │  │        编辑区域                  │   │
│  │                 │  │                                 │   │
│  │  📝 基本信息    │  │  ┌─────────────────────────────┐ │ │
│  │  🎓 教育背景    │  │  │ 张三                        │ │ │
│  │  💼 工作经验    │  │  │ 软件工程师                   │ │ │
│  │  🏆 项目经验    │  │  │ 电话: 138****1234           │ │ │
│  │  🛠️ 技能证书    │  │  │ 邮箱: zhangsan@email.com    │ │ │
│  │  📋 个人总结    │  │  └─────────────────────────────┘ │ │
│  │                 │  │                                 │   │
│  │  [拖拽到右侧]   │  │  ┌─────────────────────────────┐ │ │
│  │                 │  │  │ 教育背景                     │ │ │
│  └─────────────────┘  │  │ 北京大学 计算机科学 本科      │ │ │
│                       │  │ 2018-2022                   │ │ │
│                       │  └─────────────────────────────┘ │ │
│                       └─────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 2.1.2 拖拽组件系统
```vue
<template>
  <div class="resume-editor">
    <!-- 模块库 -->
    <div class="module-library">
      <div 
        v-for="module in modules" 
        :key="module.id"
        class="module-item"
        draggable="true"
        @dragstart="onDragStart(module)"
      >
        <i :class="module.icon"></i>
        <span>{{ module.name }}</span>
      </div>
    </div>
    
    <!-- 编辑区域 -->
    <div 
      class="edit-area"
      @dragover="onDragOver"
      @drop="onDrop"
    >
      <div 
        v-for="section in sections" 
        :key="section.id"
        class="section"
        :class="{ 'selected': selectedSection === section.id }"
        @click="selectSection(section.id)"
      >
        <component 
          :is="section.component"
          v-model="section.data"
          :config="section.config"
          @update="updateSection(section.id, $event)"
        />
      </div>
    </div>
    
    <!-- 属性面板 -->
    <div class="property-panel" v-if="selectedSection">
      <component 
        :is="selectedSectionConfig.component"
        v-model="selectedSectionConfig.data"
        @update="updateSectionConfig"
      />
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      modules: [
        { id: 'basic', name: '基本信息', icon: '📝', component: 'BasicInfo' },
        { id: 'education', name: '教育背景', icon: '🎓', component: 'Education' },
        { id: 'experience', name: '工作经验', icon: '💼', component: 'Experience' },
        { id: 'project', name: '项目经验', icon: '🏆', component: 'Project' },
        { id: 'skill', name: '技能证书', icon: '🛠️', component: 'Skill' },
        { id: 'summary', name: '个人总结', icon: '📋', component: 'Summary' }
      ],
      sections: [],
      selectedSection: null
    }
  },
  methods: {
    onDragStart(module) {
      event.dataTransfer.setData('module', JSON.stringify(module))
    },
    onDragOver(event) {
      event.preventDefault()
    },
    onDrop(event) {
      event.preventDefault()
      const module = JSON.parse(event.dataTransfer.getData('module'))
      this.addSection(module)
    },
    addSection(module) {
      const section = {
        id: Date.now(),
        type: module.id,
        component: module.component,
        data: this.getDefaultData(module.id),
        config: this.getDefaultConfig(module.id)
      }
      this.sections.push(section)
    }
  }
}
</script>
```

### 2.2 模块组件设计

#### 2.2.1 基本信息组件
```vue
<template>
  <div class="basic-info-section">
    <div class="section-header">
      <h2>基本信息</h2>
      <el-button @click="editMode = !editMode">
        {{ editMode ? '预览' : '编辑' }}
      </el-button>
    </div>
    
    <div v-if="editMode" class="edit-form">
      <el-form :model="formData" label-width="80px">
        <el-row :gutter="20">
          <el-col :span="12">
            <el-form-item label="姓名">
              <el-input v-model="formData.name" placeholder="请输入姓名" />
            </el-form-item>
          </el-col>
          <el-col :span="12">
            <el-form-item label="职位">
              <el-input v-model="formData.title" placeholder="请输入职位" />
            </el-form-item>
          </el-col>
        </el-row>
        
        <el-row :gutter="20">
          <el-col :span="12">
            <el-form-item label="电话">
              <el-input v-model="formData.phone" placeholder="请输入电话" />
            </el-form-item>
          </el-col>
          <el-col :span="12">
            <el-form-item label="邮箱">
              <el-input v-model="formData.email" placeholder="请输入邮箱" />
            </el-form-item>
          </el-col>
        </el-row>
        
        <el-form-item label="地址">
          <el-input v-model="formData.address" placeholder="请输入地址" />
        </el-form-item>
        
        <el-form-item label="个人网站">
          <el-input v-model="formData.website" placeholder="请输入个人网站" />
        </el-form-item>
      </el-form>
    </div>
    
    <div v-else class="preview-content">
      <div class="name-title">
        <h1>{{ formData.name }}</h1>
        <h2>{{ formData.title }}</h2>
      </div>
      <div class="contact-info">
        <p>📞 {{ formData.phone }}</p>
        <p>📧 {{ formData.email }}</p>
        <p>📍 {{ formData.address }}</p>
        <p v-if="formData.website">🌐 {{ formData.website }}</p>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'BasicInfo',
  props: {
    value: {
      type: Object,
      default: () => ({})
    }
  },
  data() {
    return {
      editMode: false,
      formData: {
        name: '',
        title: '',
        phone: '',
        email: '',
        address: '',
        website: ''
      }
    }
  },
  watch: {
    value: {
      handler(newVal) {
        this.formData = { ...this.formData, ...newVal }
      },
      immediate: true
    },
    formData: {
      handler(newVal) {
        this.$emit('input', newVal)
      },
      deep: true
    }
  }
}
</script>
```

#### 2.2.2 工作经验组件
```vue
<template>
  <div class="experience-section">
    <div class="section-header">
      <h2>工作经验</h2>
      <el-button @click="addExperience">添加经验</el-button>
    </div>
    
    <div class="experience-list">
      <div 
        v-for="(exp, index) in experiences" 
        :key="index"
        class="experience-item"
      >
        <div class="experience-header">
          <h3>{{ exp.company }} - {{ exp.position }}</h3>
          <span class="duration">{{ exp.startDate }} - {{ exp.endDate }}</span>
        </div>
        
        <div class="experience-content">
          <p class="description">{{ exp.description }}</p>
          <ul class="achievements">
            <li v-for="achievement in exp.achievements" :key="achievement">
              {{ achievement }}
            </li>
          </ul>
        </div>
        
        <div class="experience-actions">
          <el-button @click="editExperience(index)">编辑</el-button>
          <el-button @click="deleteExperience(index)" type="danger">删除</el-button>
        </div>
      </div>
    </div>
    
    <!-- 编辑对话框 -->
    <el-dialog v-model="dialogVisible" title="编辑工作经验">
      <el-form :model="currentExperience" label-width="80px">
        <el-form-item label="公司">
          <el-input v-model="currentExperience.company" />
        </el-form-item>
        <el-form-item label="职位">
          <el-input v-model="currentExperience.position" />
        </el-form-item>
        <el-form-item label="时间">
          <el-date-picker
            v-model="currentExperience.startDate"
            type="month"
            placeholder="开始时间"
          />
          <el-date-picker
            v-model="currentExperience.endDate"
            type="month"
            placeholder="结束时间"
          />
        </el-form-item>
        <el-form-item label="描述">
          <el-input 
            v-model="currentExperience.description" 
            type="textarea" 
            rows="3"
          />
        </el-form-item>
        <el-form-item label="成就">
          <el-input 
            v-model="currentExperience.achievements" 
            type="textarea" 
            rows="5"
            placeholder="每行一个成就"
          />
        </el-form-item>
      </el-form>
      <template #footer>
        <el-button @click="dialogVisible = false">取消</el-button>
        <el-button @click="saveExperience" type="primary">保存</el-button>
      </template>
    </el-dialog>
  </div>
</template>

<script>
export default {
  name: 'Experience',
  props: {
    value: {
      type: Array,
      default: () => []
    }
  },
  data() {
    return {
      experiences: [],
      dialogVisible: false,
      currentExperience: {},
      editingIndex: -1
    }
  },
  methods: {
    addExperience() {
      this.currentExperience = {
        company: '',
        position: '',
        startDate: '',
        endDate: '',
        description: '',
        achievements: ''
      }
      this.editingIndex = -1
      this.dialogVisible = true
    },
    editExperience(index) {
      this.currentExperience = { ...this.experiences[index] }
      this.editingIndex = index
      this.dialogVisible = true
    },
    deleteExperience(index) {
      this.experiences.splice(index, 1)
      this.$emit('input', this.experiences)
    },
    saveExperience() {
      if (this.editingIndex >= 0) {
        this.experiences[this.editingIndex] = { ...this.currentExperience }
      } else {
        this.experiences.push({ ...this.currentExperience })
      }
      this.$emit('input', this.experiences)
      this.dialogVisible = false
    }
  },
  watch: {
    value: {
      handler(newVal) {
        this.experiences = [...newVal]
      },
      immediate: true
    }
  }
}
</script>
```

## 3. 模板系统

### 3.1 模板管理

#### 3.1.1 模板分类
```javascript
const templateCategories = {
  professional: {
    name: '专业模板',
    templates: [
      {
        id: 'professional-1',
        name: '经典专业',
        description: '适合传统行业，简洁大方',
        preview: '/templates/professional-1.png',
        config: {
          font: 'SimSun',
          fontSize: 12,
          lineHeight: 1.5,
          color: '#333333',
          backgroundColor: '#ffffff'
        }
      },
      {
        id: 'professional-2',
        name: '现代简约',
        description: '适合科技行业，现代感强',
        preview: '/templates/professional-2.png',
        config: {
          font: 'Microsoft YaHei',
          fontSize: 14,
          lineHeight: 1.6,
          color: '#2c3e50',
          backgroundColor: '#ecf0f1'
        }
      }
    ]
  },
  creative: {
    name: '创意模板',
    templates: [
      {
        id: 'creative-1',
        name: '设计师风格',
        description: '适合设计、创意行业',
        preview: '/templates/creative-1.png',
        config: {
          font: 'Helvetica',
          fontSize: 13,
          lineHeight: 1.4,
          color: '#34495e',
          backgroundColor: '#f8f9fa'
        }
      }
    ]
  },
  academic: {
    name: '学术模板',
    templates: [
      {
        id: 'academic-1',
        name: '学术标准',
        description: '适合学术、研究职位',
        preview: '/templates/academic-1.png',
        config: {
          font: 'Times New Roman',
          fontSize: 12,
          lineHeight: 2.0,
          color: '#000000',
          backgroundColor: '#ffffff'
        }
      }
    ]
  }
}
```

#### 3.1.2 模板选择组件
```vue
<template>
  <div class="template-selector">
    <div class="template-categories">
      <el-tabs v-model="activeCategory">
        <el-tab-pane 
          v-for="(category, key) in categories" 
          :key="key"
          :label="category.name"
          :name="key"
        >
          <div class="template-grid">
            <div 
              v-for="template in category.templates"
              :key="template.id"
              class="template-item"
              :class="{ 'selected': selectedTemplate === template.id }"
              @click="selectTemplate(template)"
            >
              <img :src="template.preview" :alt="template.name" />
              <div class="template-info">
                <h3>{{ template.name }}</h3>
                <p>{{ template.description }}</p>
              </div>
            </div>
          </div>
        </el-tab-pane>
      </el-tabs>
    </div>
    
    <div class="template-actions">
      <el-button @click="applyTemplate" type="primary">应用模板</el-button>
      <el-button @click="previewTemplate">预览</el-button>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      activeCategory: 'professional',
      selectedTemplate: null,
      categories: templateCategories
    }
  },
  methods: {
    selectTemplate(template) {
      this.selectedTemplate = template.id
    },
    applyTemplate() {
      if (this.selectedTemplate) {
        const template = this.findTemplate(this.selectedTemplate)
        this.$emit('template-selected', template)
      }
    },
    findTemplate(id) {
      for (const category of Object.values(this.categories)) {
        const template = category.templates.find(t => t.id === id)
        if (template) return template
      }
      return null
    }
  }
}
</script>
```

### 3.2 样式系统

#### 3.2.1 CSS变量系统
```css
:root {
  /* 颜色系统 */
  --primary-color: #1890ff;
  --secondary-color: #52c41a;
  --text-color: #333333;
  --text-secondary: #666666;
  --border-color: #d9d9d9;
  --background-color: #ffffff;
  
  /* 字体系统 */
  --font-family: 'Microsoft YaHei', sans-serif;
  --font-size-base: 14px;
  --font-size-lg: 16px;
  --font-size-sm: 12px;
  
  /* 间距系统 */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  
  /* 圆角系统 */
  --border-radius-sm: 2px;
  --border-radius-md: 4px;
  --border-radius-lg: 8px;
}

/* 模板样式类 */
.template-professional {
  --primary-color: #333333;
  --font-family: 'SimSun', serif;
  --font-size-base: 12px;
}

.template-modern {
  --primary-color: #2c3e50;
  --font-family: 'Microsoft YaHei', sans-serif;
  --font-size-base: 14px;
}

.template-creative {
  --primary-color: #34495e;
  --font-family: 'Helvetica', sans-serif;
  --font-size-base: 13px;
}
```

#### 3.2.2 响应式样式
```css
/* 桌面端样式 */
@media (min-width: 1200px) {
  .resume-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 40px;
  }
  
  .section {
    margin-bottom: 30px;
  }
  
  .section-title {
    font-size: 18px;
    margin-bottom: 15px;
  }
}

/* 平板端样式 */
@media (max-width: 1199px) and (min-width: 768px) {
  .resume-container {
    max-width: 100%;
    padding: 20px;
  }
  
  .section {
    margin-bottom: 20px;
  }
  
  .section-title {
    font-size: 16px;
    margin-bottom: 12px;
  }
}

/* 手机端样式 */
@media (max-width: 767px) {
  .resume-container {
    padding: 10px;
  }
  
  .section {
    margin-bottom: 15px;
  }
  
  .section-title {
    font-size: 14px;
    margin-bottom: 10px;
  }
  
  .contact-info {
    flex-direction: column;
  }
}
```

## 4. 导出系统

### 4.1 Word文档导出

#### 4.1.1 Word生成器
```python
from docx import Document
from docx.shared import Inches, Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.oxml.shared import OxmlElement, qn

class WordResumeGenerator:
    def __init__(self, template_config):
        self.document = Document()
        self.config = template_config
        self.setup_document()
    
    def setup_document(self):
        """设置文档基本样式"""
        # 设置页面边距
        sections = self.document.sections
        for section in sections:
            section.top_margin = Inches(0.5)
            section.bottom_margin = Inches(0.5)
            section.left_margin = Inches(0.5)
            section.right_margin = Inches(0.5)
    
    def generate_resume(self, resume_data):
        """生成简历"""
        # 添加标题
        self.add_header(resume_data['basic'])
        
        # 添加各个部分
        if 'education' in resume_data:
            self.add_education(resume_data['education'])
        
        if 'experience' in resume_data:
            self.add_experience(resume_data['experience'])
        
        if 'projects' in resume_data:
            self.add_projects(resume_data['projects'])
        
        if 'skills' in resume_data:
            self.add_skills(resume_data['skills'])
        
        if 'summary' in resume_data:
            self.add_summary(resume_data['summary'])
        
        return self.document
    
    def add_header(self, basic_info):
        """添加简历头部"""
        # 姓名和职位
        name_para = self.document.add_paragraph()
        name_run = name_para.add_run(basic_info['name'])
        name_run.font.size = Pt(24)
        name_run.font.bold = True
        name_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        
        title_para = self.document.add_paragraph()
        title_run = title_para.add_run(basic_info['title'])
        title_run.font.size = Pt(16)
        title_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        
        # 联系信息
        contact_para = self.document.add_paragraph()
        contact_text = f"电话: {basic_info['phone']} | 邮箱: {basic_info['email']}"
        if basic_info.get('address'):
            contact_text += f" | 地址: {basic_info['address']}"
        contact_run = contact_para.add_run(contact_text)
        contact_run.font.size = Pt(10)
        contact_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        
        self.document.add_paragraph()  # 空行
    
    def add_education(self, education_list):
        """添加教育背景"""
        self.add_section_title("教育背景")
        
        for edu in education_list:
            edu_para = self.document.add_paragraph()
            edu_para.add_run(f"{edu['school']} - {edu['degree']}").bold = True
            edu_para.add_run(f" ({edu['graduation_year']})")
            
            if edu.get('major'):
                major_para = self.document.add_paragraph()
                major_para.add_run(f"专业: {edu['major']}")
                major_para.paragraph_format.left_indent = Inches(0.2)
            
            if edu.get('gpa'):
                gpa_para = self.document.add_paragraph()
                gpa_para.add_run(f"GPA: {edu['gpa']}")
                gpa_para.paragraph_format.left_indent = Inches(0.2)
    
    def add_experience(self, experience_list):
        """添加工作经验"""
        self.add_section_title("工作经验")
        
        for exp in experience_list:
            # 公司名称和职位
            exp_para = self.document.add_paragraph()
            exp_para.add_run(f"{exp['company']} - {exp['position']}").bold = True
            exp_para.add_run(f" ({exp['start_date']} - {exp['end_date']})")
            
            # 工作描述
            if exp.get('description'):
                desc_para = self.document.add_paragraph()
                desc_para.add_run(exp['description'])
                desc_para.paragraph_format.left_indent = Inches(0.2)
            
            # 工作成就
            if exp.get('achievements'):
                for achievement in exp['achievements']:
                    achievement_para = self.document.add_paragraph()
                    achievement_para.add_run(f"• {achievement}")
                    achievement_para.paragraph_format.left_indent = Inches(0.4)
            
            self.document.add_paragraph()  # 空行
    
    def add_section_title(self, title):
        """添加章节标题"""
        title_para = self.document.add_paragraph()
        title_run = title_para.add_run(title)
        title_run.font.size = Pt(14)
        title_run.font.bold = True
        title_para.paragraph_format.space_after = Pt(6)
    
    def save_document(self, filename):
        """保存文档"""
        self.document.save(filename)
```

#### 4.1.2 样式定制
```python
def apply_template_style(self, template_name):
    """应用模板样式"""
    if template_name == 'professional':
        self.apply_professional_style()
    elif template_name == 'modern':
        self.apply_modern_style()
    elif template_name == 'creative':
        self.apply_creative_style()

def apply_professional_style(self):
    """应用专业模板样式"""
    # 设置字体
    style = self.document.styles['Normal']
    style.font.name = 'SimSun'
    style.font.size = Pt(12)
    
    # 设置标题样式
    heading_style = self.document.styles['Heading 1']
    heading_style.font.name = 'SimSun'
    heading_style.font.size = Pt(14)
    heading_style.font.bold = True

def apply_modern_style(self):
    """应用现代模板样式"""
    # 设置字体
    style = self.document.styles['Normal']
    style.font.name = 'Microsoft YaHei'
    style.font.size = Pt(14)
    
    # 设置标题样式
    heading_style = self.document.styles['Heading 1']
    heading_style.font.name = 'Microsoft YaHei'
    heading_style.font.size = Pt(16)
    heading_style.font.bold = True
    heading_style.font.color.rgb = RGBColor(44, 62, 80)
```

### 4.2 PDF导出

#### 4.2.1 PDF生成器
```python
from reportlab.lib.pagesizes import letter, A4
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import inch
from reportlab.lib import colors

class PDFResumeGenerator:
    def __init__(self, template_config):
        self.styles = getSampleStyleSheet()
        self.config = template_config
        self.setup_styles()
    
    def setup_styles(self):
        """设置样式"""
        # 标题样式
        self.styles.add(ParagraphStyle(
            name='ResumeTitle',
            parent=self.styles['Title'],
            fontSize=24,
            spaceAfter=12,
            alignment=1  # 居中
        ))
        
        # 副标题样式
        self.styles.add(ParagraphStyle(
            name='ResumeSubtitle',
            parent=self.styles['Normal'],
            fontSize=16,
            spaceAfter=6,
            alignment=1  # 居中
        ))
        
        # 章节标题样式
        self.styles.add(ParagraphStyle(
            name='SectionTitle',
            parent=self.styles['Heading1'],
            fontSize=14,
            spaceAfter=6,
            spaceBefore=12
        ))
        
        # 正文样式
        self.styles.add(ParagraphStyle(
            name='ResumeBody',
            parent=self.styles['Normal'],
            fontSize=10,
            spaceAfter=3
        ))
    
    def generate_resume(self, resume_data, filename):
        """生成PDF简历"""
        doc = SimpleDocTemplate(filename, pagesize=A4)
        story = []
        
        # 添加头部
        story.extend(self.create_header(resume_data['basic']))
        
        # 添加各个部分
        if 'education' in resume_data:
            story.extend(self.create_education(resume_data['education']))
        
        if 'experience' in resume_data:
            story.extend(self.create_experience(resume_data['experience']))
        
        if 'projects' in resume_data:
            story.extend(self.create_projects(resume_data['projects']))
        
        if 'skills' in resume_data:
            story.extend(self.create_skills(resume_data['skills']))
        
        doc.build(story)
    
    def create_header(self, basic_info):
        """创建简历头部"""
        elements = []
        
        # 姓名
        name = Paragraph(basic_info['name'], self.styles['ResumeTitle'])
        elements.append(name)
        
        # 职位
        title = Paragraph(basic_info['title'], self.styles['ResumeSubtitle'])
        elements.append(title)
        
        # 联系信息
        contact_info = f"电话: {basic_info['phone']} | 邮箱: {basic_info['email']}"
        if basic_info.get('address'):
            contact_info += f" | 地址: {basic_info['address']}"
        
        contact = Paragraph(contact_info, self.styles['ResumeBody'])
        elements.append(contact)
        
        elements.append(Spacer(1, 20))
        return elements
    
    def create_education(self, education_list):
        """创建教育背景部分"""
        elements = []
        
        # 章节标题
        title = Paragraph("教育背景", self.styles['SectionTitle'])
        elements.append(title)
        
        # 教育信息表格
        data = [['学校', '学位', '专业', '毕业年份']]
        for edu in education_list:
            data.append([
                edu['school'],
                edu['degree'],
                edu.get('major', ''),
                edu['graduation_year']
            ])
        
        table = Table(data, colWidths=[2*inch, 1.5*inch, 2*inch, 1*inch])
        table.setStyle(TableStyle([
            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
            ('FONTSIZE', (0, 0), (-1, -1), 10),
            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),
            ('GRID', (0, 0), (-1, -1), 1, colors.black),
            ('BACKGROUND', (0, 0), (-1, 0), colors.grey)
        ]))
        
        elements.append(table)
        elements.append(Spacer(1, 12))
        return elements
    
    def create_experience(self, experience_list):
        """创建工作经验部分"""
        elements = []
        
        # 章节标题
        title = Paragraph("工作经验", self.styles['SectionTitle'])
        elements.append(title)
        
        for exp in experience_list:
            # 公司名称和职位
            company_title = f"{exp['company']} - {exp['position']}"
            company_para = Paragraph(company_title, self.styles['ResumeBody'])
            elements.append(company_para)
            
            # 时间
            time_text = f"{exp['start_date']} - {exp['end_date']}"
            time_para = Paragraph(time_text, self.styles['ResumeBody'])
            elements.append(time_para)
            
            # 描述
            if exp.get('description'):
                desc_para = Paragraph(exp['description'], self.styles['ResumeBody'])
                elements.append(desc_para)
            
            # 成就
            if exp.get('achievements'):
                for achievement in exp['achievements']:
                    achievement_text = f"• {achievement}"
                    achievement_para = Paragraph(achievement_text, self.styles['ResumeBody'])
                    elements.append(achievement_para)
            
            elements.append(Spacer(1, 6))
        
        return elements
```

### 4.3 HTML导出

#### 4.3.1 HTML生成器
```python
class HTMLResumeGenerator:
    def __init__(self, template_config):
        self.config = template_config
        self.css_styles = self.get_css_styles()
    
    def generate_resume(self, resume_data):
        """生成HTML简历"""
        html_content = f"""
        <!DOCTYPE html>
        <html lang="zh-CN">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>{resume_data['basic']['name']} - 简历</title>
            <style>
                {self.css_styles}
            </style>
        </head>
        <body>
            <div class="resume-container">
                {self.create_header_html(resume_data['basic'])}
                {self.create_education_html(resume_data.get('education', []))}
                {self.create_experience_html(resume_data.get('experience', []))}
                {self.create_projects_html(resume_data.get('projects', []))}
                {self.create_skills_html(resume_data.get('skills', []))}
            </div>
        </body>
        </html>
        """
        return html_content
    
    def create_header_html(self, basic_info):
        """创建头部HTML"""
        return f"""
        <div class="header">
            <h1 class="name">{basic_info['name']}</h1>
            <h2 class="title">{basic_info['title']}</h2>
            <div class="contact-info">
                <span>📞 {basic_info['phone']}</span>
                <span>📧 {basic_info['email']}</span>
                {f'<span>📍 {basic_info["address"]}</span>' if basic_info.get('address') else ''}
            </div>
        </div>
        """
    
    def create_education_html(self, education_list):
        """创建教育背景HTML"""
        if not education_list:
            return ""
        
        education_items = ""
        for edu in education_list:
            education_items += f"""
            <div class="education-item">
                <h3>{edu['school']}</h3>
                <p class="degree">{edu['degree']} - {edu.get('major', '')}</p>
                <p class="year">{edu['graduation_year']}</p>
            </div>
            """
        
        return f"""
        <div class="section">
            <h2 class="section-title">教育背景</h2>
            {education_items}
        </div>
        """
    
    def get_css_styles(self):
        """获取CSS样式"""
        return """
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .resume-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #1890ff;
            padding-bottom: 20px;
        }
        
        .name {
            font-size: 28px;
            font-weight: bold;
            margin: 0 0 10px 0;
            color: #1890ff;
        }
        
        .title {
            font-size: 18px;
            margin: 0 0 15px 0;
            color: #666;
        }
        
        .contact-info {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .contact-info span {
            font-size: 14px;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #1890ff;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        
        .education-item, .experience-item {
            margin-bottom: 15px;
        }
        
        .education-item h3, .experience-item h3 {
            font-size: 16px;
            font-weight: bold;
            margin: 0 0 5px 0;
        }
        
        .degree, .company {
            font-size: 14px;
            color: #666;
            margin: 0 0 5px 0;
        }
        
        .year, .duration {
            font-size: 12px;
            color: #999;
        }
        
        @media print {
            body {
                background-color: white;
                padding: 0;
            }
            
            .resume-container {
                box-shadow: none;
                padding: 20px;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .resume-container {
                padding: 20px;
            }
            
            .contact-info {
                flex-direction: column;
                gap: 10px;
            }
        }
        """
```

## 5. 版本控制系统

### 5.1 版本管理

#### 5.1.1 版本数据结构
```sql
-- 简历版本表
CREATE TABLE resume_versions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    resume_id BIGINT NOT NULL,
    version_number INT NOT NULL,
    content JSON NOT NULL,
    template_config JSON,
    change_description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by BIGINT NOT NULL,
    FOREIGN KEY (resume_id) REFERENCES resumes(id),
    FOREIGN KEY (created_by) REFERENCES users(id)
);
```

#### 5.1.2 版本控制API
```python
class ResumeVersionControl:
    def __init__(self, resume_id):
        self.resume_id = resume_id
    
    def create_version(self, content, template_config, description, user_id):
        """创建新版本"""
        # 获取当前版本号
        current_version = self.get_latest_version_number()
        new_version_number = current_version + 1
        
        # 保存版本
        version = ResumeVersion.objects.create(
            resume_id=self.resume_id,
            version_number=new_version_number,
            content=content,
            template_config=template_config,
            change_description=description,
            created_by=user_id
        )
        
        return version
    
    def get_version_history(self):
        """获取版本历史"""
        return ResumeVersion.objects.filter(
            resume_id=self.resume_id
        ).order_by('-version_number')
    
    def restore_version(self, version_number, user_id):
        """恢复到指定版本"""
        version = ResumeVersion.objects.get(
            resume_id=self.resume_id,
            version_number=version_number
        )
        
        # 创建新版本记录恢复操作
        self.create_version(
            content=version.content,
            template_config=version.template_config,
            description=f"恢复到版本 {version_number}",
            user_id=user_id
        )
        
        return version
    
    def compare_versions(self, version1, version2):
        """比较两个版本"""
        diff_result = {
            'added': [],
            'removed': [],
            'modified': []
        }
        
        # 比较内容差异
        content1 = version1.content
        content2 = version2.content
        
        # 实现差异比较逻辑
        # ...
        
        return diff_result
```

### 5.2 版本对比界面

#### 5.2.1 版本历史组件
```vue
<template>
  <div class="version-history">
    <div class="history-header">
      <h3>版本历史</h3>
      <el-button @click="showVersionDialog = true">创建版本</el-button>
    </div>
    
    <div class="version-list">
      <div 
        v-for="version in versions" 
        :key="version.id"
        class="version-item"
        :class="{ 'current': version.version_number === currentVersion }"
      >
        <div class="version-info">
          <span class="version-number">v{{ version.version_number }}</span>
          <span class="version-date">{{ formatDate(version.created_at) }}</span>
          <span class="version-description">{{ version.change_description }}</span>
        </div>
        
        <div class="version-actions">
          <el-button @click="viewVersion(version)">查看</el-button>
          <el-button @click="compareVersion(version)">对比</el-button>
          <el-button @click="restoreVersion(version)" type="primary">恢复</el-button>
        </div>
      </div>
    </div>
    
    <!-- 版本对比对话框 -->
    <el-dialog v-model="compareDialogVisible" title="版本对比" width="80%">
      <div class="version-compare">
        <div class="compare-left">
          <h4>版本 {{ compareData.left.version_number }}</h4>
          <div class="compare-content" v-html="compareData.left.content"></div>
        </div>
        <div class="compare-right">
          <h4>版本 {{ compareData.right.version_number }}</h4>
          <div class="compare-content" v-html="compareData.right.content"></div>
        </div>
      </div>
    </el-dialog>
  </div>
</template>

<script>
export default {
  data() {
    return {
      versions: [],
      currentVersion: 1,
      showVersionDialog: false,
      compareDialogVisible: false,
      compareData: {
        left: null,
        right: null
      }
    }
  },
  methods: {
    async loadVersions() {
      const response = await this.$api.getResumeVersions(this.resumeId)
      this.versions = response.data
    },
    
    async createVersion() {
      const description = await this.$prompt('请输入版本描述')
      if (description) {
        await this.$api.createResumeVersion({
          resume_id: this.resumeId,
          content: this.currentContent,
          template_config: this.currentTemplate,
          change_description: description
        })
        this.loadVersions()
      }
    },
    
    async restoreVersion(version) {
      try {
        await this.$confirm(`确定要恢复到版本 ${version.version_number} 吗？`)
        await this.$api.restoreResumeVersion(this.resumeId, version.version_number)
        this.$emit('version-restored', version.content)
        this.loadVersions()
      } catch (error) {
        // 用户取消
      }
    },
    
    compareVersion(version) {
      this.compareData.left = version
      this.compareData.right = this.versions.find(v => v.version_number === this.currentVersion)
      this.compareDialogVisible = true
    }
  },
  
  mounted() {
    this.loadVersions()
  }
}
</script>
```

## 6. 性能优化

### 6.1 编辑器性能优化
- **虚拟滚动**：长列表虚拟滚动
- **懒加载**：图片和资源懒加载
- **防抖处理**：输入防抖处理
- **缓存机制**：编辑内容缓存

### 6.2 导出性能优化
- **异步处理**：大文档异步生成
- **队列处理**：导出任务队列
- **压缩优化**：文档压缩优化
- **CDN分发**：生成文件CDN分发

### 6.3 存储优化
- **数据压缩**：JSON数据压缩存储
- **增量保存**：增量保存机制
- **清理策略**：历史版本清理
- **备份策略**：定期备份策略

## 7. 安全考虑

### 7.1 数据安全
- **内容验证**：简历内容安全验证
- **文件扫描**：上传文件病毒扫描
- **权限控制**：文档访问权限控制
- **数据加密**：敏感信息加密存储

### 7.2 导出安全
- **格式验证**：导出格式验证
- **大小限制**：文件大小限制
- **访问日志**：导出访问日志
- **水印保护**：文档水印保护
